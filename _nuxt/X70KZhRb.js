import{v as L,g as m,x as T,R as P,r as n,K as g,S as H,T as J,B as q,U as d,o as $,c as j,a as F,t as G,b as K,V as z}from"./BzkyDoGK.js";const Q=()=>({sayExample:()=>console.log("HELLO FROM COMPOSABLES")}),X=L({__name:"MainButton",props:{text:{type:String},color:{type:String},textColor:{type:String},visible:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},progress:{type:Boolean,default:!1}},emits:["click"],setup(t,{emit:o}){const e=t,a=o,{setMainButtonParams:i,onMainButtonClicked:l,hideMainButton:u,showMainButtonProgress:s,hideMainButtonProgress:b}=be();return m(()=>e.text,r=>{i({text:r})}),m(()=>e.color,r=>{i({color:r})}),m(()=>e.textColor,r=>{i({text_color:r})}),m(()=>e.visible,r=>{i({is_visible:r})}),m(()=>e.disabled,r=>{i({is_active:!r})}),m(()=>e.progress,r=>{r?s():b()}),l(()=>a("click")),T(()=>{e.progress?s():b(),i({text:e.text,text_color:e.textColor,color:e.color,is_active:!e.disabled,is_visible:e.visible})}),P(()=>{b(),u()}),(r,f)=>null}}),{initData:Y,initDataUnsafe:Z,version:ee,platform:te,isVersionAtLeast:_,sendData:ae,close:ne}=Telegram.WebApp,D=n(!1),oe=(...t)=>{Telegram.WebApp.ready(...t),D.value=!0},I=t=>Telegram.WebApp.platform===t,V=I("unknown"),ie={ClosingConfirmation:"6.2",CloudStorage:"6.9",RequestWriteAccess:"6.9",RequestContact:"6.9",SettingsButton:"7.0",BiometricManager:"7.2",DisableVerticalSwipes:"7.7"},re=t=>_(ie[t]),se=!V&&Telegram.WebApp.initData==="";function A(){return{initData:Y,initDataUnsafe:Z,version:ee,platform:te,isVersionAtLeast:_,onEvent:(t,o,e={manual:!1})=>{const{manual:a}=e,i=()=>{Telegram.WebApp.onEvent(t,o)},l=()=>{Telegram.WebApp.offEvent(t,o)};return a?i():(T(i),P(l)),{off:l}},sendData:ae,ready:oe,close:ne,isReady:H(D),isPlatform:I,isPlatformUnknown:V,isFeatureSupported:re,canSendData:se}}n(Telegram.WebApp.BackButton.isVisible);Telegram.WebApp.BiometricManager;n(Telegram.WebApp.BiometricManager.isInited);n(Telegram.WebApp.BiometricManager.isBiometricAvailable);n(Telegram.WebApp.BiometricManager.biometricType);n(Telegram.WebApp.BiometricManager.isAccessRequested);n(Telegram.WebApp.BiometricManager.isAccessGranted);n(Telegram.WebApp.BiometricManager.isAccessGranted);n(Telegram.WebApp.BiometricManager.deviceId);Telegram.WebApp;n(Telegram.WebApp.isClosingConfirmationEnabled);const c=Telegram.WebApp.CloudStorage;function le(t,o){return new Promise((e,a)=>{c.setItem(t,o,(i,l)=>{i&&a(i),e(l)})})}function pe(t){return new Promise((o,e)=>{c.getItem(t,(a,i)=>{a&&e(a),o(i)})})}function ue(t){return new Promise((o,e)=>{c.getItems(t,(a,i)=>{a&&e(a),o(i)})})}function me(t){return new Promise((o,e)=>{c.removeItem(t,(a,i)=>{a&&e(a),o(i)})})}function ge(t){return new Promise((o,e)=>{c.removeItems(t,(a,i)=>{a&&e(a),o(i)})})}function ce(){return new Promise((t,o)=>{c.getKeys((e,a)=>{e&&o(e),t(a)})})}function W(){return{setStorageItem:le,getStorageItem:pe,getStorageItems:ue,removeStorageItem:me,removeStorageItems:ge,getStorageKeys:ce}}Telegram.WebApp.HapticFeedback;const k=n(Telegram.WebApp.MainButton.text),E=n(Telegram.WebApp.MainButton.color),U=n(Telegram.WebApp.MainButton.textColor),N=n(Telegram.WebApp.MainButton.isVisible),O=n(Telegram.WebApp.MainButton.isActive),R=n(Telegram.WebApp.MainButton.isProgressVisible);function p(){k.value=Telegram.WebApp.MainButton.text,E.value=Telegram.WebApp.MainButton.color,U.value=Telegram.WebApp.MainButton.textColor,N.value=Telegram.WebApp.MainButton.isVisible,O.value=Telegram.WebApp.MainButton.isActive,R.value=Telegram.WebApp.MainButton.isProgressVisible}function v(...t){Telegram.WebApp.MainButton.setText(...t),p()}function M(...t){Telegram.WebApp.MainButton.show(...t),p()}function S(...t){Telegram.WebApp.MainButton.hide(...t),p()}function y(...t){Telegram.WebApp.MainButton.enable(...t),p()}function h(...t){Telegram.WebApp.MainButton.disable(...t),p()}function x(...t){Telegram.WebApp.MainButton.showProgress(...t),p()}function C(...t){Telegram.WebApp.MainButton.hideProgress(...t),p()}function B(...t){Telegram.WebApp.MainButton.setParams(...t),p()}function be(){const{onEvent:t}=A(),o=(e,a)=>t("mainButtonClicked",e,a);return{mainButtonText:g({get(){return k.value},set(e){v(e)}}),mainButtonColor:g({get(){return E.value},set(e){B({color:e})}}),mainButtonTextColor:g({get(){return U.value},set(e){B({text_color:e})}}),isMainButtonVisible:g({get(){return N.value},set(e){e?M():S()}}),isMainButtonActive:g({get(){return O.value},set(e){e?y():h()}}),isMainButtonProgressVisible:g({get(){return R.value},set(e){e?x():C()}}),setMainButtonText:v,onMainButtonClicked:o,showMainButton:M,hideMainButton:S,enableMainButton:y,disableMainButton:h,showMainButtonProgress:x,hideMainButtonProgress:C,setMainButtonParams:B}}Telegram.WebApp;Telegram.WebApp;Telegram.WebApp;Telegram.WebApp;A();n(Telegram.WebApp.SettingsButton.isVisible);n(Telegram.WebApp.colorScheme);n(Telegram.WebApp.themeParams);n(Telegram.WebApp.headerColor);n(Telegram.WebApp.backgroundColor);n(Telegram.WebApp.isExpanded);n(Telegram.WebApp.viewportHeight);n(Telegram.WebApp.viewportStableHeight);n(Telegram.WebApp.isVerticalSwipesEnabled);const w="initData",Ae="tgWebApp",de=J(Ae,()=>{const t=n(null),o=n(null),e=n(null),a=()=>{t.value=A(),t.value.version>"6.0"&&(i(),l())},i=()=>{window.Telegram.WebApp.CloudStorage.getItem(w,(u,s)=>{typeof s=="string"&&s===""?(o.value=A().initDataUnsafe,W().setStorageItem(w,JSON.stringify(o.value))):o.value=JSON.parse(s)})},l=()=>{window.Telegram.WebApp.CloudStorage.getItem("initDataSave",(u,s)=>{typeof s=="string"&&s===""?(e.value=A().initData,W().setStorageItem("initDataSave",JSON.stringify(e.value))):e.value=JSON.parse(s)})};return{webAppData:t,dataUnsafe:o,init:a,dataSafe:e}}),Be={key:0},Te={__name:"MyIndex",setup(t){const o=q(),{sayExample:e}=Q();e();const a=de();a.init();const i=async()=>{const l=new URLSearchParams(a.dataSafe),u=l.get("hash");l.delete("hash"),l.sort();let s="";for(const[r,f]of l.entries())s+=r+"="+f+`
`;s=s.slice(0,-1);let b=[s,u];console.log(s);try{const r=await $fetch("/api/v1/test-validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b),baseURL:"http://127.0.0.1:8080"});console.log("response: ",r)}catch(r){console.log("error: ",r)}};return T(()=>{o.$sayHello()}),(l,u)=>d(a).dataUnsafe?($(),j("div",Be,[F("h1",null,"Hello Telegram mini app, my name is "+G(d(a).dataUnsafe.user.first_name),1),K(d(X),{onClick:i})])):z("",!0)}},We=Te;export{We as default};
